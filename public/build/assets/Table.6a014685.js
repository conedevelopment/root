import{A as U}from"./Actions.02b97a6a.js";import{_ as g,r as d,o as i,c as o,f as _,w as M,C as $,d as r,t as b,e as m,g as q,v as x,h as S,F as y,a as f,b as p,m as H,i as v,j as w,L as A,k as L,n as O}from"./app.f181b8f7.js";const I={props:{extracts:{type:Array,required:!0}},data(){return{_extract:null,form:this.$inertia.form(this.name,{})}},computed:{name(){return window.location.pathname+"-extracts"},options(){return this.extracts.map(e=>({value:e.key,formatted_value:e.name}))}},methods:{submit(){const e=this.extracts.find(s=>s.key=this._extract);this.form.get(e.url)}}};function j(e,s,t,h,c,n){const u=d("FormHandler");return i(),o("form",{onSubmit:s[1]||(s[1]=M(()=>{},["prevent"])),onReset:s[2]||(s[2]=M(()=>{},["prevent"]))},[_(u,{nullable:"",class:"form-group--inline",component:"Select",modelValue:c._extract,"onUpdate:modelValue":[s[0]||(s[0]=a=>c._extract=a),n.submit],name:n.name,id:n.name,form:c.form,label:e.__("Extract"),options:n.options},null,8,["modelValue","name","id","form","label","options","onUpdate:modelValue"])],32)}const T=g(I,[["render",j]]),E={mixins:[$],props:{filters:{type:Array,default:()=>[]},query:{type:Object,required:!0}},emits:["update:query"],computed:{activeFilters(){return this.filters.filter(e=>e.active).length}},methods:{emit(){this.$emit("update:query")},reset(){this.$inertia.get(this.$parent.items.path)}}},R={class:"app-operation__filter"},B=["aria-label"],D={key:0,class:"btn__counter"},N={class:"app-drawer"},P={class:"app-drawer__title"},z={class:"app-drawer__inner"},G={class:"form-group--reset"},J=["aria-label"];function K(e,s,t,h,c,n){const u=d("Icon"),a=d("FormHandler");return i(),o("div",R,[r("button",{type:"button",class:"btn btn--secondary btn--icon btn--has-counter","aria-label":e.isOpen?e.__("Close filters"):e.__("Open filters"),onClick:s[0]||(s[0]=(...l)=>e.toggle&&e.toggle(...l))},[_(u,{class:"btn__icon btn__icon--start",name:e.isOpen?"filter-list-off":"filter-list"},null,8,["name"]),n.activeFilters>0?(i(),o("span",D,b(n.activeFilters),1)):m("",!0)],8,B),q(r("div",N,[r("h2",P,[S(b(e.__("Filters"))+" ",1),r("button",{type:"button",class:"btn btn--secondary btn--sm btn--icon",onClick:s[1]||(s[1]=(...l)=>e.close&&e.close(...l))},[_(u,{class:"btn__icon btn__icon--sm",name:"close"})])]),r("div",z,[(i(!0),o(y,null,f(t.filters,l=>(i(),p(a,H(l,{modelValue:t.query[l.key],"onUpdate:modelValue":[k=>t.query[l.key]=k,n.emit],form:t.query,key:l.key,name:l.key,label:l.name}),null,16,["modelValue","onUpdate:modelValue","form","name","label"]))),128)),r("div",G,[r("button",{type:"button",class:"btn btn--sm btn--icon btn--tertiary","aria-label":e.__("Reset"),onClick:s[2]||(s[2]=(...l)=>n.reset&&n.reset(...l))},b(e.__("Reset")),9,J)])])],512),[[x,e.isOpen]])])}const Q=g(E,[["render",K]]),W={props:{items:{type:Array,required:!0},selection:{type:Array,required:!0},query:{type:Object,required:!0},columns:{type:Array,required:!0}},emits:["update:query"],watch:{indeterminate(e,s){this.$refs.input.indeterminate=e}},computed:{selected:{get(){return this.selection.length>0&&this.selection.length===this.items.length},set(e){e?this.$parent.selectAll():this.$parent.clearSelection()}},allMatching:{get(){return this.$parent.allMatching},set(e){e?this.$parent.selectAll(!0):this.$parent.clearSelection()}},indeterminate(){return this.selection.length>0&&this.selection.length<this.items.length},totalItems(){return this.allMatching?this.$parent.items.total:this.selection.length}},methods:{icon(e){return this.query.sort.by!==e?"unfold-more":this.query.sort.order==="desc"?"unfold-more-top":"unfold-more-bottom"},sort(e){this.query.sort.by=e,this.query.sort.order=this.query.sort.order==="desc"?"asc":"desc",this.$emit("update:query")}}},X={key:0,scope:"col"},Y={class:"th-helper"},Z={class:"form-check"},ee=r("span",{class:"form-label form-check__label","aria-label":""},null,-1),te={class:"dropdown__item"},se=r("hr",{class:"dropdown__divider"},null,-1),ne={class:"dropdown__item"},le={class:"form-check"},re={class:"form-label form-check__label"},ie={class:"th-helper"},ae=["onClick"],oe=r("th",{scope:"col"},"\xA0",-1);function ce(e,s,t,h,c,n){const u=d("Dropdown"),a=d("Icon");return i(),o("thead",null,[r("tr",null,[e.$parent.actions.length>0?(i(),o("th",X,[r("div",Y,[r("label",Z,[q(r("input",{ref:"input",class:"form-check__control",type:"checkbox","onUpdate:modelValue":s[0]||(s[0]=l=>n.selected=l),style:{"margin-inline-end":"0"}},null,512),[[v,n.selected]]),ee]),_(u,{id:"table-selection-control"},{default:w(()=>[r("li",te,b(e.__(":count items are selected",{count:n.totalItems})),1),se,r("li",ne,[r("label",le,[q(r("input",{class:"form-check__control",type:"checkbox","onUpdate:modelValue":s[1]||(s[1]=l=>n.allMatching=l)},null,512),[[v,n.allMatching]]),r("span",re,b(e.__("Select all matching (:count)",{count:e.$parent.items.total})),1)])])]),_:1})])])):m("",!0),(i(!0),o(y,null,f(t.columns,l=>(i(),o("th",{key:l.name,scope:"col"},[r("div",ie,[S(b(l.label)+" ",1),l.sortable?(i(),o("button",{key:0,type:"button",onClick:k=>n.sort(l.name),class:"table-sort-btn"},[_(a,{name:n.icon(l.name)},null,8,["name"])],8,ae)):m("",!0)])]))),128)),oe])])}const ue=g(W,[["render",ce]]),de={components:{Link:A},props:{items:{type:Object,required:!0},query:{type:Object,required:!0}},emits:["update:query"],data(){return{counts:[15,25,50,100]}},methods:{emit(){this.$emit("update:query")}}},me={class:"list-footer"},_e={class:"list-footer__pager"},he=["value"],be=["value"],pe={for:"per-page"},ye={class:"list-footer__pagination"};function fe(e,s,t,h,c,n){const u=d("Link");return i(),o("div",me,[r("div",_e,[q(r("select",{class:"form-control form-control--sm",id:"per-page","onUpdate:modelValue":[s[0]||(s[0]=a=>t.query.per_page=a),s[1]||(s[1]=(...a)=>n.emit&&n.emit(...a))]},[c.counts.includes(t.query.per_page)?m("",!0):(i(),o("option",{key:0,disabled:"",value:t.query.per_page},b(e.__("Custom (:count)",{count:t.query.per_page})),9,he)),(i(!0),o(y,null,f(c.counts,a=>(i(),o("option",{key:a,value:a},b(a),9,be))),128))],512),[[L,t.query.per_page,void 0,{number:!0}]]),r("label",pe,b(e.__("of :count items",{count:t.items.total})),1)]),r("ul",ye,[(i(!0),o(y,null,f(t.items.links,(a,l)=>(i(),o("li",{key:l},[_(u,{class:"btn btn--primary btn--sm",type:"button",as:a.url===null||a.active?"button":"a",disabled:a.url===null||a.active,href:a.url,"aria-current":a.active?"page":"",innerHTML:a.label},null,8,["as","disabled","href","aria-current","innerHTML"])]))),128))])])}const ge=g(de,[["render",fe]]),qe={components:{Link:A},props:{item:{type:Object,required:!0}},computed:{selected:{get(){return this.$parent.selected(this.item)},set(e){e?this.$parent.select(this.item):this.$parent.deselect(this.item)}}},methods:{destroy(){this.$inertia.delete(this.item.url,{onBefore:()=>confirm(this.__("Are you sure?")),onStart:e=>this.$parent.deselect(this.item)})}}},ke={key:0,scope:"row"},ve={class:"form-check",style:{position:"relative",top:"3px"}},we=r("span",{class:"form-label form-check__label","aria-label":""},null,-1),Ve=["innerHTML"],Me={class:"table__actions"},Se=["aria-label"];function Ae(e,s,t,h,c,n){const u=d("Icon"),a=d("Link");return i(),o("tr",{class:O({"is-selected":n.selected,"is-trashed":t.item.trashed})},[e.$parent.actions.length>0?(i(),o("th",ke,[r("label",ve,[q(r("input",{class:"form-check__control",type:"checkbox","onUpdate:modelValue":s[0]||(s[0]=l=>n.selected=l)},null,512),[[v,n.selected]]),we])])):m("",!0),(i(!0),o(y,null,f(t.item.fields,l=>(i(),o("td",{key:`${t.item.id}-${l.name}`,innerHTML:l.formatted_value},null,8,Ve))),128)),r("td",null,[r("div",Me,[t.item.abilities.delete?(i(),o("button",{key:0,type:"button",class:"btn btn--icon btn--delete btn--sm","aria-label":e.__("Delete"),onClick:s[1]||(s[1]=(...l)=>n.destroy&&n.destroy(...l))},[_(u,{class:"btn__icon",name:"delete"})],8,Se)):m("",!0),t.item.abilities.view?(i(),p(a,{key:1,href:t.item.url,class:"btn btn--icon btn--tertiary btn--sm","aria-label":e.__("View")},{default:w(()=>[_(u,{class:"btn__icon",name:"view"})]),_:1},8,["href","aria-label"])):m("",!0),t.item.abilities.update?(i(),p(a,{key:2,href:`${t.item.url}/edit`,class:"btn btn--icon btn--tertiary btn--sm","aria-label":e.__("Edit")},{default:w(()=>[_(u,{class:"btn__icon",name:"edit"})]),_:1},8,["href","aria-label"])):m("",!0)])])],2)}const Ce=g(qe,[["render",Ae]]),Fe={components:{Actions:U,Extracts:T,Filters:Q,Head:ue,Pagination:ge,Row:Ce},props:{actions:{type:Array,default:()=>[]},extracts:{type:Array,default:()=>[]},filters:{type:Array,default:()=>[]},items:{type:Object,required:!0}},data(){return{selection:[],allMatching:!1,processing:!1,query:this.$inertia.form(window.location.href,this.items.query)}},computed:{columns(){var s,t;return(((t=(s=this.items.data)==null?void 0:s[0])==null?void 0:t.fields)||[]).map(h=>({label:h.label,name:h.name,sortable:h.sortable,searchable:h.searchable}))}},methods:{selected(e){return this.selection.includes(e.id)},select(e){this.selection.includes(e.id)||this.selection.push(e.id)},deselect(e){const s=this.selection.indexOf(e.id);s!==-1&&this.selection.splice(s,1),this.allMatching=!1},selectAll(e=!1){this.allMatching=e,this.selection=this.items.data.map(s=>s.id)},clearSelection(){this.allMatching=!1,this.selection=[]},fetch(){this.query.transform(e=>({...e,page:1})).get(this.items.path,{replace:!0,preserveState:!0,preserveScroll:!0,onStart:()=>{this.processing=!0},onFinish:()=>{this.clearSelection(),this.processing=!1}})}}},Ue={key:0,class:"app-operation"},$e={class:"app-list"},xe={class:"card"},He={class:"table-responsive"},Le={key:0,class:"table table--striped table--clear-border table--rounded"},Oe={key:1,class:"alert alert--info"};function Ie(e,s,t,h,c,n){const u=d("Filters"),a=d("Actions"),l=d("Extracts"),k=d("Head"),C=d("Row"),F=d("Pagination");return i(),o("div",null,[t.filters.length>0||t.actions.length>0||t.extracts.length>0?(i(),o("div",Ue,[t.filters.length>0?(i(),p(u,{key:0,query:c.query,filters:t.filters,"onUpdate:query":n.fetch},null,8,["query","filters","onUpdate:query"])):m("",!0),t.actions.length>0?(i(),p(a,{key:1,actions:t.actions,"all-matching":c.allMatching,selection:c.selection,onSuccess:n.clearSelection},null,8,["actions","all-matching","selection","onSuccess"])):m("",!0),t.extracts.length>0?(i(),p(l,{key:2,extracts:t.extracts},null,8,["extracts"])):m("",!0)])):m("",!0),r("div",$e,[r("div",xe,[r("div",He,[t.items.data.length?(i(),o("table",Le,[_(k,{items:t.items.data,query:c.query,selection:c.selection,columns:n.columns,"onUpdate:query":n.fetch},null,8,["items","query","selection","columns","onUpdate:query"]),r("tbody",null,[(i(!0),o(y,null,f(t.items.data,V=>(i(),p(C,{key:V.id,item:V},null,8,["item"]))),128))])])):(i(),o("div",Oe,b(e.__("No results found.")),1))])]),_(F,{query:c.query,items:t.items,"onUpdate:query":n.fetch},null,8,["query","items","onUpdate:query"])])])}const Ee=g(Fe,[["render",Ie]]);export{Ee as T};
